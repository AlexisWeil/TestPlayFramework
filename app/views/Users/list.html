#{extends 'main.html' /}

Users' list :
<ul>
    #{list items:users, as:'user'}
        <li>${user.firstname} ${user.lastname}</li>
    #{/list}
</ul>

Add a new user :

#{form @Users.addUser()}
    <label for="AddUserFirstname">Firstname : </label>
    <input id="AddUserFirstname" type="text" name="user.firstname" value="${flash['user.firstname']}" />
    #{ifError 'user.firstname'}<span style="color: red;">Firstname is required</span>#{/ifError}<br/><br/>

    <label for="AddUserLastname">Lastname : </label>
    <input id="AddUserLastname" type="text" name="user.lastname" value="${flash['user.lastname']}"/>
    #{ifError 'user.lastname'}<span style="color: red;">Lastname is required</span>#{/ifError}<br/><br/>

    <input type="submit" value="Submit" id="AddUserSubmit" />
#{/form}

<div id="TestRaphael"></div>

<script type="text/javascript">
    $(function() {
        var paper = Raphael("TestRaphael", 200, 200);
//        var rect = paper.rect(50, 50, 50, 50, 4).attr({ fill: '#CA4141', stroke: '#9D2C2C'});
        paper.path("M277.667,300.667c0,6.627-5.358,12-11.967,12h-96.733  c-6.609,0-11.967-5.373-11.967-12v-34c0-6.627,5.358-12,11.967-12H265.7c6.609,0,11.967,5.373,11.967,12V300.667z");
    });
</script>

<script type="text/javascript">
    $(function() {
        $('#AddUserSubmit').click(function(event) {
            event.preventDefault();

            addUserAjax();
        });
    });

    function addUserAjax() {
        var addUserUrl = #{jsAction @Users.testUser(':firstname', ':lastname') /}

        var firstname = $('#AddUserFirstname').val();
        var lastname = $('#AddUserLastname').val();

        $.getJSON(
            addUserUrl({ firstname: firstname, lastname: lastname}),
            function(json) {
                alert(json);
            }
        );
    }
</script>